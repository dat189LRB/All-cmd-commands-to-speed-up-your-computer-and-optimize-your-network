@echo off
color 0a
title SUPER TANG TOC LAPTOP - by DAT189
echo ================================================
echo      BAT SCRIPT TOI UU TOAN DIEN LAPTOP WINDOWS
echo ================================================

:: Xoa clipboard
echo Xoa bo nho Clipboard...
echo off | clip
echo Hoan tat.
echo.


:: Xoa file rac Windows
echo Xoa file rac va file tam...
del /s /f /q %temp%\*.* >nul 2>&1
del /s /f /q C:\Windows\Temp\*.* >nul 2>&1
echo Hoan tat.
echo.

:: Xoa cache Windows Update
echo Xoa cache Windows Update...
net stop wuauserv >nul
net stop bits >nul
del /q /f /s %windir%\SoftwareDistribution\*.*
net start wuauserv >nul
net start bits >nul
echo Hoan tat.
echo.

:: Tat ung dung nen khong can thiet
echo Tat ung dung nen khong can thiet...
reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\BackgroundAccessApplications" /v GlobalUserDisabled /t REG_DWORD /d 1 /f
echo Hoan tat.
echo.

echo ===============================
echo  TỐI ƯU HÓA KẾT NỐI MẠNG (Wi-Fi / LAN)
echo ===============================
echo.

:: Giải phóng và gia hạn IP
echo [1/10] Đang giải phóng IP...
ipconfig /release
echo [2/10] Đang làm mới IP...
ipconfig /renew

:: Xóa cache DNS và đăng ký lại
echo [3/10] Đang xóa bộ nhớ đệm DNS...
ipconfig /flushdns
echo [4/10] Đang đăng ký lại DNS...
ipconfig /registerdns

:: Reset TCP/IP và Winsock
echo [5/10] Đang đặt lại TCP/IP...
netsh int ip reset
echo [6/10] Đang đặt lại Winsock...
netsh winsock reset

:: Bật tối ưu TCP
echo [7/10] Đang cấu hình tối ưu TCP...
netsh interface tcp set global autotuninglevel=normal
netsh interface tcp set global rss=enabled
netsh interface tcp set global chimney=enabled

:: Reset tường lửa
echo [8/10] Đang reset tường lửa Windows...
netsh advfirewall reset

:: Xóa cache ARP
echo [9/10] Đang xóa cache ARP...
arp -d
arp -a


:: 
echo [10/10]  Kiểm tra và giải phóng cache giao tiếp mạng..
netsh interface ip delete arpcache



:: Hiển thị cấu hình mạng hiện tại
echo.
echo --- Thông tin cấu hình mạng ---
ipconfig /all

:: Hiển thị thiết lập TCP hiện tại
echo.
echo --- Thiết lập TCP hiện tại ---
netsh interface tcp show global

:: Toi uu hoa o dia SSD / HDD
echo  Dang toi uu hoa o dia SSD/HDD...
defrag C: /O
echo Hoan tat!
echo.

:: Kiểm tra trạng thái ổ đĩa (ổ khỏe hay lỗi)
echo  TINH TRANG O DIA:
wmic diskdrive get model,status
echo Neu la "OK" -> O dia dang HOAT DONG BINH THUONG.
echo Neu la "Pred Fail" -> Co the SAP HONG, can kiem tra ngay.
echo.

echo ===============CLEAN================
echo luu y (press OK de HOAN TAT DON DEP) 
echo (CO THE NHAN CANCEL DE BO QUA NEU KHONG CAN)
cleanmgr
echo ===============HOAN TAT=============

echo ================================================
echo    TAT CA CAC BUOC DA HOAN THANH!
echo    VUI LONG KHOI DONG LAI LAPTOP.
echo ================================================
:MENU :: Display menu to continue or exit
echo.
echo ===============MENU==================
echo 1. Fix loi win nhe (w)
echo 2. Fix loi win manh ( phai co internet ) (s)
echo 4. Exit (e)
set /p choice=Nhap lua chon cua ban (w/s/p/e): 

:: Handle user choice
if "%choice%"=="w" sfc /scannow
if "%choice%"=="s" dism /online /cleanup-image /restorehealth
if "%choice%"=="e" exit /b

:: If the user input is invalid
echo Lua chon khong hop le. Vui long nhap w , s , p hoac e de thoat .
goto MENU


